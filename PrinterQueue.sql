$attExpire = ""
$attTouch = ""
function Query-AD-PreStep ()
{
    $objSearcher2 = New-Object System.DirectoryServices.DirectorySearcher $strDomain
    [void]$objSearcher2.PropertiesToLoad.Add("givenName")
    [void]$objSearcher2.PropertiesToLoad.Add("sn")
    $objSearcher2.Filter= "(&(ObjectClass=contact)(Name=PIVAuthTask))"
    $test = $objSearcher2.FindOne();
    if ($test -ne $null) {
        $attExpire = $test.Properties.Item("givenName")
        $attTouch = $test.Properties.Item("sn")
    }
    else {
        $attExpire = "attExpire"
        $attTouch = "attTouch"
    }
    return @("Admin-Description","Admin-Display-Name","Allowed-Attributes","Allowed-Attributes-Effective","Allowed-Child-Classes","Allowed-Child-Classes-Effective","Asset-Number","Bridgehead-Server-List-BL","Bytes-Per-Minute","Canonical-Name","Common-Name","Create-Time-Stamp","Default-Priority","Description","Display-Name","Display-Name-Printable","Driver-Name","Driver-Version","DSA-Signature","DS-Core-Propagation-Data","Extension-Name","Flags","From-Entry","Frs-Computer-Reference-BL","FRS-Member-Reference-BL","FSMO-Role-Owner","Instance-Type","Is-Critical-System-Object","Is-Deleted","Is-Member-Of-DL","Is-Privilege-Holder","Is-Recycled","Keywords","Last-Known-Parent","Location","Managed-By","Managed-Objects","Mastered-By","Modify-Time-Stamp","ms-COM-PartitionSetLink","ms-COM-UserLink","ms-DFSR-ComputerReferenceBL","ms-DFSR-MemberReferenceBL","ms-DS-Approx-Immed-Subordinates","ms-DS-AuthenticatedTo-Accountlist","ms-DS-Claim-Shares-Possible-Values-With-BL","MS-DS-Consistency-Child-Count","MS-DS-Consistency-Guid","ms-DS-Enabled-Feature-BL","ms-DS-Host-Service-Account-BL","ms-DS-Is-Domain-For","ms-DS-Is-Full-Replica-For","ms-DS-Is-Partial-Replica-For","ms-DS-Is-Primary-Computer-For","ms-DS-KrbTgt-Link-BL","ms-DS-Last-Known-RDN","ms-DS-local-Effective-Deletion-Time","ms-DS-local-Effective-Recycle-Time","ms-DS-Mastered-By","ms-DS-Members-For-Az-Role-BL","ms-DS-Members-Of-Resource-Property-List-BL","ms-DS-NC-Repl-Cursors","ms-DS-NC-Repl-Inbound-Neighbors","ms-DS-NC-Repl-Outbound-Neighbors","ms-DS-NC-RO-Replica-Locations-BL","ms-DS-NC-Type","ms-DS-Non-Members-BL","ms-DS-Object-Reference-BL","ms-DS-OIDToGroup-Link-BL","ms-DS-Operations-For-Az-Role-BL","ms-DS-Operations-For-Az-Task-BL","ms-DS-Principal-Name","ms-DS-PSO-Applied","ms-DS-Repl-Attribute-Meta-Data","ms-DS-Repl-Value-Meta-Data","ms-DS-Revealed-DSAs","ms-DS-Revealed-List-BL","ms-DS-Settings","ms-DS-Tasks-For-Az-Role-BL","ms-DS-Tasks-For-Az-Task-BL","ms-DS-TDO-Egress-BL","ms-DS-TDO-Ingress-BL","ms-DS-Value-Type-Reference-BL","ms-Exch-Owner-BL","msSFU-30-Posix-Member-Of","netboot-SCP-BL","Non-Security-Member-BL","NT-Security-Descriptor","Obj-Dist-Name","Object-Category","Object-Class","Object-Guid","Object-Version","Operating-System","Operating-System-Hotfix","Operating-System-Service-Pack","Operating-System-Version","Other-Well-Known-Objects","Partial-Attribute-Deletion-List","Partial-Attribute-Set","Physical-Location-Object","Port-Name","Possible-Inferiors","Print-Attributes","Print-Bin-Names","Print-Collate","Print-Color","Print-Duplex-Supported","Print-End-Time","Printer-Name","Print-Form-Name","Print-Keep-Printed-Jobs","Print-Language","Print-MAC-Address","Print-Max-Copies","Print-Max-Resolution-Supported","Print-Max-X-Extent","Print-Max-Y-Extent","Print-Media-Ready","Print-Media-Supported","Print-Memory","Print-Min-X-Extent","Print-Min-Y-Extent","Print-Network-Address","Print-Notify","Print-Number-Up","Print-Orientations-Supported","Print-Owner","Print-Pages-Per-Minute","Print-Rate","Print-Rate-Unit","Print-Separator-File","Print-Share-Name","Print-Spooling","Print-Stapling-Supported","Print-Start-Time","Print-Status","Priority","Proxied-Object-Name","Proxy-Addresses","Query-Policy-BL","RDN","Repl-Property-Meta-Data","Repl-UpToDate-Vector","Reports","Reps-From","Reps-To","Revision","SD-Rights-Effective","Server-Name","Server-Reference-BL","Short-Server-Name","Show-In-Advanced-View-Only","Site-Object-BL","Structural-Object-Class","Sub-Refs","SubSchemaSubEntry","System-Flags","UNC-Name","USN-Changed","USN-Created","USN-DSA-Last-Obj-Removed","USN-Intersite","USN-Last-Obj-Rem","USN-Source","Version-Number","Wbem-Path","Well-Known-Objects","When-Changed","When-Created","WWW-Home-Page","WWW-Page-Other")
}

$arrAttributes = @("Admin-Description",
"Admin-Display-Name",
"Allowed-Attributes",
"Allowed-Attributes-Effective",
"Allowed-Child-Classes",
"Allowed-Child-Classes-Effective",
"Asset-Number",
"Bridgehead-Server-List-BL",
"Bytes-Per-Minute",
"Canonical-Name",
"Common-Name",
"Create-Time-Stamp",
"Default-Priority",
"Description",
"Display-Name",
"Display-Name-Printable",
"Driver-Name",
"Driver-Version",
"DSA-Signature",
"DS-Core-Propagation-Data",
"Extension-Name",
"Flags",
"From-Entry",
"Frs-Computer-Reference-BL",
"FRS-Member-Reference-BL",
"FSMO-Role-Owner",
"Instance-Type",
"Is-Critical-System-Object",
"Is-Deleted",
"Is-Member-Of-DL",
"Is-Privilege-Holder",
"Is-Recycled",
"Keywords",
"Last-Known-Parent",
"Location",
"Managed-By",
"Managed-Objects",
"Mastered-By",
"Modify-Time-Stamp",
"ms-COM-PartitionSetLink",
"ms-COM-UserLink",
"ms-DFSR-ComputerReferenceBL",
"ms-DFSR-MemberReferenceBL",
"ms-DS-Approx-Immed-Subordinates",
"ms-DS-AuthenticatedTo-Accountlist",
"ms-DS-Claim-Shares-Possible-Values-With-BL",
"MS-DS-Consistency-Child-Count",
"MS-DS-Consistency-Guid",
"ms-DS-Enabled-Feature-BL",
"ms-DS-Host-Service-Account-BL",
"ms-DS-Is-Domain-For",
"ms-DS-Is-Full-Replica-For",
"ms-DS-Is-Partial-Replica-For",
"ms-DS-Is-Primary-Computer-For",
"ms-DS-KrbTgt-Link-BL",
"ms-DS-Last-Known-RDN",
"ms-DS-local-Effective-Deletion-Time",
"ms-DS-local-Effective-Recycle-Time",
"ms-DS-Mastered-By",
"ms-DS-Members-For-Az-Role-BL",
"ms-DS-Members-Of-Resource-Property-List-BL",
"ms-DS-NC-Repl-Cursors",
"ms-DS-NC-Repl-Inbound-Neighbors",
"ms-DS-NC-Repl-Outbound-Neighbors",
"ms-DS-NC-RO-Replica-Locations-BL",
"ms-DS-NC-Type",
"ms-DS-Non-Members-BL",
"ms-DS-Object-Reference-BL",
"ms-DS-OIDToGroup-Link-BL",
"ms-DS-Operations-For-Az-Role-BL",
"ms-DS-Operations-For-Az-Task-BL",
"ms-DS-Principal-Name",
"ms-DS-PSO-Applied",
"ms-DS-Repl-Attribute-Meta-Data",
"ms-DS-Repl-Value-Meta-Data",
"ms-DS-Revealed-DSAs",
"ms-DS-Revealed-List-BL",
"ms-DS-Settings",
"ms-DS-Tasks-For-Az-Role-BL",
"ms-DS-Tasks-For-Az-Task-BL",
"ms-DS-TDO-Egress-BL",
"ms-DS-TDO-Ingress-BL",
"ms-DS-Value-Type-Reference-BL",
"ms-Exch-Owner-BL",
"msSFU-30-Posix-Member-Of",
"netboot-SCP-BL",
"Non-Security-Member-BL",
"NT-Security-Descriptor",
"Obj-Dist-Name",
"Object-Category",
"Object-Class",
"Object-Guid",
"Object-Version",
"Operating-System",
"Operating-System-Hotfix",
"Operating-System-Service-Pack",
"Operating-System-Version",
"Other-Well-Known-Objects",
"Partial-Attribute-Deletion-List",
"Partial-Attribute-Set",
"Physical-Location-Object",
"Port-Name",
"Possible-Inferiors",
"Print-Attributes",
"Print-Bin-Names",
"Print-Collate",
"Print-Color",
"Print-Duplex-Supported",
"Print-End-Time",
"Printer-Name",
"Print-Form-Name",
"Print-Keep-Printed-Jobs",
"Print-Language",
"Print-MAC-Address",
"Print-Max-Copies",
"Print-Max-Resolution-Supported",
"Print-Max-X-Extent",
"Print-Max-Y-Extent",
"Print-Media-Ready",
"Print-Media-Supported",
"Print-Memory",
"Print-Min-X-Extent",
"Print-Min-Y-Extent",
"Print-Network-Address",
"Print-Notify",
"Print-Number-Up",
"Print-Orientations-Supported",
"Print-Owner",
"Print-Pages-Per-Minute",
"Print-Rate",
"Print-Rate-Unit",
"Print-Separator-File",
"Print-Share-Name",
"Print-Spooling",
"Print-Stapling-Supported",
"Print-Start-Time",
"Print-Status",
"Priority",
"Proxied-Object-Name",
"Proxy-Addresses",
"Query-Policy-BL",
"RDN",
"Repl-Property-Meta-Data",
"Repl-UpToDate-Vector",
"Reports",
"Reps-From",
"Reps-To",
"Revision",
"SD-Rights-Effective",
"Server-Name",
"Server-Reference-BL",
"Short-Server-Name",
"Show-In-Advanced-View-Only",
"Site-Object-BL",
"Structural-Object-Class",
"Sub-Refs",
"SubSchemaSubEntry",
"System-Flags",
"UNC-Name",
"USN-Changed",
"USN-Created",
"USN-DSA-Last-Obj-Removed",
"USN-Intersite",
"USN-Last-Obj-Rem",
"USN-Source",
"Version-Number",
"Wbem-Path",
"Well-Known-Objects",
"When-Changed",
"When-Created",
"WWW-Home-Page",
"WWW-Page-Other"
)
$filter="(&(objectCategory=printQueue)(objectClass=printQueue))"